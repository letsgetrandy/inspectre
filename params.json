{"name":"Specter","tagline":"Visual/CSS regression testing with PhantomJS","body":"Specter adds [Resemble.js](http://huddle.github.com/Resemble.js/) image comparison functionality to [CasperJS](http://github.com/n1k0/casperjs) testing and navigation framework for [PhantomJS](http://github.com/ariya/phantomjs/), in order to produce automated visual regression testing.\r\n\r\n\r\n### Why?\r\n\r\nThe problem with functional UI tests is that they make assertions on HTML markup, not the actual rendering. You can't know through automated tests if something has visually broke, too much margin, disabled state etc.  This situation is exacerbated by the increasing use of CSS3 for visual state changes that were traditionally built with JavaScript and DOM manipulation, ':target' pseudoclass or keyframes for example. Read more on Huddle's Engineering blog: [CSS Regression Testing](http://tldr.huddle.com/blog/css-testing/).\r\n\r\n\r\n### Installation\r\n\r\nSpecter requires [CasperJS](http://github.com/n1k0/casperjs), which can be installed on Mac via Homebrew (`brew install casperjs`) or installed manually on any other system by cloning the repo.\r\n\r\nTo use Specter, just clone this repo and then link `bin/specter` into your path and make it executable. Eg:\r\n\r\n```\r\n# local\r\n$ ln -s bin/specter ~/bin/specter && chmod 755 ~/bin/specter\r\n\r\nOR\r\n\r\n# global\r\n$ sudo ln -s bin/specter /usr/local/bin/specter && chmod 755 /usr/local/bin/specter\r\n```\r\n\r\n### Usage\r\n\r\nCheck out the [demo](http://github.com/letsgetrandy/specter/tree/master/demo) for a full working example (run `specter demo` from the command line).\r\n\r\nSpecter adds a global `specter` object to your casper tests, with a `screenshot()` method which requires two parameters:\r\n\r\n```\r\nspecter.screenshot(String css_selector, String file_name)\r\n\r\n    css_selector:  A selector to define what you want to capture\r\n    file_name   :  A descriptor to use when saving the screenshot\r\n```\r\n\r\nJust write your [casper functional tests](http://casperjs.org/testing.html) as normal, but have specter capture screenshots as you go.\r\n\r\n```javascript\r\n\r\n/* global casper:false */\r\n\r\ncasper\r\n.start('http://localhost/', function () {\r\n    casper.viewport(1024, 600);\r\n    specter.turn_off_animations();\r\n    specter.screenshot(\"main > .content\", \"main\");\r\n    this.test.assertExists('form#login #id_username', 'username field');\r\n    this.test.assertExists('form#login #id_password', 'password field');\r\n})\r\n.thenOpen('http://localhost/password-reset/', function () {\r\n    specter.screenshot(\"main > .content\", \"password-reset\");\r\n})\r\n.run(function(){\r\n    this.test.done(0);\r\n});\r\n\r\n```\r\n\r\nSpecter will compare the after the functional tests have finished. Just invoke your tests by calling `specter` rather than `casperjs`.\r\n\r\nSpecter can run a single test file:\r\n\r\n```bash\r\n$ specter tests/test-login.js\r\n```\r\n\r\nOr, multiple files:\r\n\r\n```bash\r\n$ specter tests/test-login.js tests/test-homepage.js tests/test-checkout.js\r\n```\r\n\r\nOr, it can recursively run every test file in a specified directory:\r\n\r\n```bash\r\n$ specter tests\r\n```\r\n\r\n\r\n### Workflow\r\n\r\n* Define what screenshots you need in your regular tests\r\n* Find the screenshot directory and check that they look as you expect.  These images will be used as a baseline.  Subsequent test runs will report if the latest screenshot is different to the baseline\r\n* Commit/push these baseline images with your normal tests (presuming you're using a version control system)\r\n* Run the tests again.  New screenshots will be created to compare against the baseline image.  These new images can be ignored, they will be replaced every test run. They don't need to be committed\r\n* If there are test failures, image diffs will be generated.\r\n\r\n\r\n### Configuration\r\n\r\n```\r\n$ cat .specterrc\r\n\r\n[specter]\r\ntestroot = static/styles/tests\r\nbaseline = static/styles/screenshots\r\ndiff = /tmp/specter/diff\r\nfail = /tmp/specter/fail\r\n```\r\n\r\n\r\n### Demo\r\n\r\nRun all demo tests simply by passing the demo directory as an argument:\r\n\r\n```\r\n$ specter demo\r\n```\r\n\r\nOr, run a single demo test by passing just that file as an argument:\r\n\r\n```\r\n$ specter demo/test-facebook.js\r\n```\r\n\r\n\r\n--------------------------------------\r\n\r\nMaintained by [Randy Hunt](http://github.com/letsgetrandy)\r\nSpecter is based on PhantomCSS, originally created by [James Cryer](http://github.com/jamescryer) and the Huddle development team.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}