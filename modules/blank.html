<html>
<head>
<style>
/*
#comparison_form {
    display:block;
    position:absolute;
    border:0;
    top:-1px;
    left:-1px;
    height:1px;
    width:1px;
    overflow:hidden;
}
*/
</style>
<script type="text/javascript" src="resemble.js"></script>
<script>

var result;

window.diffing = {
    done: false,
    hasImage: false,
    run: run,
    getResult: function(){
        window.diffing.done = false;
        return result;
    }
};

function run() {

    function render(data) {
        document.getElementById('diff').innerHTML =
                '<img src="' + data.getImageDataUrl() + '"/>';
        window.diffing.hasImage = true;
    }
    var imga = document.getElementById('image_a'),
        imgb = document.getElementById('image_b');

    resemble(imga.files[0]).compareTo(imgb.files[0]).
            ignoreAntialiasing().onComplete(function(data)
    {
        if (Number(data.misMatchPercentage) > 0.05) {
            result = data.misMatchPercentage;
        } else {
            result = false;
        }
        window.diffing.done = true;
        if (Number(data.misMatchPercentage) > 0.05) {
            render(data);
        }
    });
}
</script>
</head>

<body>
    Blank page for image comparisons.
    <div id="comparison_form">
        <form id="diff_form">
            <input type="file" id="image_a" name="a">
            <input type="file" id="image_b" name="b">
        </form>
        <div id="diff"></div>
    </div>
</body>
</html>
